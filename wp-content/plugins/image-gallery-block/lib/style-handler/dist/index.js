!function(){"use strict";var t=window.wp.data,e=window.lodash,o=window.wp.blocks;function n(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function r(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function c(t,e){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=function(t,e){if(t){if("string"==typeof t)return s(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){o&&(t=o);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,l=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return c=t.done,t},e:function(t){l=!0,i=t},f:function(){try{c||null==o.return||o.return()}finally{if(l)throw i}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}!function(){var s=eb_style_handler.editor_type,l=function(t,e){return t&&e?t+"//"+e:null},a=function(){},u=function(){},b={};"edit-site"===s?b=(0,t.select)("core/edit-site"):"edit-post"===s&&(b=(0,t.select)("core/edit-post")),u=b.__experimentalGetPreviewDeviceType,window.ebEditCurrentPreviewOption=u();var d=(0,t.select)("core/editor"),f=d.isSavingPost,p=void 0===f?a:f,y=d.isAutosavingPost,v=void 0===y?a:y,m=d.isSavingNonPostEntityChanges,k=void 0===m?a:m,w=function(){var n=(0,t.select)("core").getEditedEntityRecord,r=void 0===n?a:n,i=(0,t.select)("core/block-editor").getBlocks,u=void 0===i?a:i,b=(0,t.select)("core/editor").getCurrentPostId,d=(void 0===b?a:b)(),f=u(),p={};!function t(n){var i,s=c(n);try{for(s.s();!(i=s.n()).done;){var a=i.value,u=a.attributes,b=u.blockMeta,d=u.blockRoot,f=u.blockId,y=u.commonStyles,v=u.customCss,m=a.innerBlocks;if((0,e.isFunction)(o.isReusableBlock)&&(0,o.isReusableBlock)(a)){var k,w=r("postType","wp_block",a.attributes.ref)||{},h=c(w.content?(0,o.parse)((0,e.isFunction)(w.content)?w.content(w):w.content):[]);try{for(h.s();!(k=h.n()).done;){var O=k.value,P=O.attributes,_=P.blockMeta,j=P.blockRoot,S=P.blockId,B=P.commonStyles,E=P.customCss,T=O.innerBlocks;_&&"essential_block"===j&&(p[S]=g(_,B,E)),T.length>0&&t(T)}}catch(t){h.e(t)}finally{h.f()}}else if((0,e.isFunction)(o.isTemplatePart)&&(0,o.isTemplatePart)(a)){var A=a.attributes,C=A.theme,R=A.slug,I=r("postType","wp_template_part",l(C,R))||{},D=I.blocks,x=void 0===D?[]:D,F=I.innerBlocks,M=void 0===F?[]:F;t(x),t(M)}else b&&"essential_block"===d&&(p[f]=g(b,y,v));m.length>0&&t(m)}}catch(t){s.e(t)}finally{s.f()}}(f);var y=JSON.stringify(p);jQuery.ajax({type:"POST",url:ajaxurl,data:{data:y,id:d,editorType:s,action:"eb_write_block_css",nonce:eb_style_handler.sth_nonce},error:function(t){console.log(t)}})},g=function(t,e,o){var c={};return"object"!=i(t)||("object"===i(e)?(t.desktop&&e.desktop&&(c.desktop=t.desktop+e.desktop),t.tab&&e.tab&&(c.tab=t.tab+e.tab),t.mobile&&e.mobile&&(c.mobile=t.mobile+e.mobile)):c=function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?n(Object(o),!0).forEach((function(e){r(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({},t),"string"==typeof o&&o.length>0&&(c.custom_css=o)),c},h=function(){if(window.ebEditCurrentPreviewOption!==u()){var e=u();window.ebEditCurrentPreviewOption=e;var o=lodash.isFunction,n=wp.blocks,r=n.parse,i=void 0===r?a:r,s=n.isReusableBlock,b=void 0===s?a:s,d=n.isTemplatePart,f=void 0===d?a:d,p=(0,t.select)("core").getEditedEntityRecord,y=void 0===p?a:p,v=(0,t.select)("core/block-editor").getBlocks,m=void 0===v?a:v,k=(0,t.dispatch)("core/block-editor").updateBlockAttributes,w=void 0===k?a:k,g=m(),h=[];!function t(e){var n,r=c(e);try{for(r.s();!(n=r.n()).done;){var s=n.value,a=s.clientId,u=s.innerBlocks,d=void 0===u?[]:u,p=s.attributes;if("essential_block"===(void 0===p?{}:p).blockRoot)h.push(a);else if(o(b)&&b(s)){var v=y("postType","wp_block",s.attributes.ref)||{};t(v.content?i(o(v.content)?v.content(v):v.content):[])}else if(o(f)&&f(s)){var m=s.attributes,k=m.theme,w=m.slug,g=y("postType","wp_template_part",l(k,w))||{},O=g.blocks,P=void 0===O?[]:O,_=g.innerBlocks,j=void 0===_?[]:_;t(P),t(j)}d.length>0&&t(d)}}catch(t){r.e(t)}finally{r.f()}}(g),w(h,{resOption:e})}};"edit-site"===s?(0,t.subscribe)((function(){k()&&w(),h()})):"edit-post"===s&&(0,t.subscribe)((function(){p()&&!v()&&w(),h()}))}()}();